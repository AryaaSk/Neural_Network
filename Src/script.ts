interface DataPoint {
    inputs: number[];
    expectedOutputs: number[];
}

let DATA: DataPoint[] = JSON.parse('[{"inputs":[-120,203.5],"expectedOutputs":[0,1]},{"inputs":[-208,126.5],"expectedOutputs":[0,1]},{"inputs":[-215,41.5],"expectedOutputs":[0,1]},{"inputs":[-173,-65.5],"expectedOutputs":[0,1]},{"inputs":[-73,-113.5],"expectedOutputs":[0,1]},{"inputs":[42,-122.5],"expectedOutputs":[0,1]},{"inputs":[144,-118.5],"expectedOutputs":[0,1]},{"inputs":[214,-74.5],"expectedOutputs":[0,1]},{"inputs":[242,-1.5],"expectedOutputs":[0,1]},{"inputs":[237,86.5],"expectedOutputs":[0,1]},{"inputs":[195,150.5],"expectedOutputs":[0,1]},{"inputs":[107,183.5],"expectedOutputs":[0,1]},{"inputs":[-2,202.5],"expectedOutputs":[0,1]},{"inputs":[-56,161.5],"expectedOutputs":[0,1]},{"inputs":[-125,120.5],"expectedOutputs":[0,1]},{"inputs":[-144,61.5],"expectedOutputs":[0,1]},{"inputs":[-96,-8.5],"expectedOutputs":[0,1]},{"inputs":[-5,-47.5],"expectedOutputs":[0,1]},{"inputs":[123,-49.5],"expectedOutputs":[0,1]},{"inputs":[172,3.5],"expectedOutputs":[0,1]},{"inputs":[138,67.5],"expectedOutputs":[0,1]},{"inputs":[59,12.5],"expectedOutputs":[0,1]},{"inputs":[-11,40.5],"expectedOutputs":[0,1]},{"inputs":[-87,85.5],"expectedOutputs":[0,1]},{"inputs":[2,116.5],"expectedOutputs":[0,1]},{"inputs":[-14,85.5],"expectedOutputs":[0,1]},{"inputs":[76,61.5],"expectedOutputs":[0,1]},{"inputs":[109,105.5],"expectedOutputs":[0,1]},{"inputs":[51,129.5],"expectedOutputs":[0,1]},{"inputs":[5,164.5],"expectedOutputs":[0,1]},{"inputs":[-59,36.5],"expectedOutputs":[0,1]},{"inputs":[-165,-2.5],"expectedOutputs":[0,1]},{"inputs":[-79,-58.5],"expectedOutputs":[0,1]},{"inputs":[82,-86.5],"expectedOutputs":[0,1]},{"inputs":[-35,-1.5],"expectedOutputs":[0,1]},{"inputs":[27,49.5],"expectedOutputs":[0,1]},{"inputs":[-132,32.5],"expectedOutputs":[0,1]},{"inputs":[-133,143.5],"expectedOutputs":[0,1]},{"inputs":[-69,124.5],"expectedOutputs":[0,1]},{"inputs":[-111,-29.5],"expectedOutputs":[0,1]},{"inputs":[-133,109.5],"expectedOutputs":[0,1]},{"inputs":[-198,59.5],"expectedOutputs":[0,1]},{"inputs":[-153,-40.5],"expectedOutputs":[0,1]},{"inputs":[-91,-111.5],"expectedOutputs":[0,1]},{"inputs":[72,-128.5],"expectedOutputs":[0,1]},{"inputs":[188,-35.5],"expectedOutputs":[0,1]},{"inputs":[181,119.5],"expectedOutputs":[0,1]},{"inputs":[110,46.5],"expectedOutputs":[0,1]},{"inputs":[-54,-89.5],"expectedOutputs":[0,1]},{"inputs":[62,-57.5],"expectedOutputs":[0,1]},{"inputs":[19,-65.5],"expectedOutputs":[0,1]},{"inputs":[59,-19.5],"expectedOutputs":[0,1]},{"inputs":[74,131.5],"expectedOutputs":[0,1]},{"inputs":[64,111.5],"expectedOutputs":[0,1]},{"inputs":[25,27.5],"expectedOutputs":[0,1]},{"inputs":[47,158.5],"expectedOutputs":[0,1]},{"inputs":[11,184.5],"expectedOutputs":[0,1]},{"inputs":[-73,186.5],"expectedOutputs":[0,1]},{"inputs":[-132,88.5],"expectedOutputs":[0,1]},{"inputs":[-120,-31.5],"expectedOutputs":[0,1]},{"inputs":[-39,155.5],"expectedOutputs":[0,1]},{"inputs":[-78,27.5],"expectedOutputs":[0,1]},{"inputs":[-61,138.5],"expectedOutputs":[0,1]},{"inputs":[-182,30.5],"expectedOutputs":[0,1]},{"inputs":[-201,63.5],"expectedOutputs":[0,1]},{"inputs":[-240,44.5],"expectedOutputs":[0,1]},{"inputs":[-204,-75.5],"expectedOutputs":[0,1]},{"inputs":[-178,-97.5],"expectedOutputs":[0,1]},{"inputs":[-182,-67.5],"expectedOutputs":[0,1]},{"inputs":[-52,-131.5],"expectedOutputs":[0,1]},{"inputs":[-9,-135.5],"expectedOutputs":[0,1]},{"inputs":[77,-105.5],"expectedOutputs":[0,1]},{"inputs":[138,62.5],"expectedOutputs":[0,1]},{"inputs":[177,-9.5],"expectedOutputs":[0,1]},{"inputs":[114,156.5],"expectedOutputs":[0,1]},{"inputs":[105,92.5],"expectedOutputs":[0,1]},{"inputs":[33,160.5],"expectedOutputs":[0,1]},{"inputs":[-42,98.5],"expectedOutputs":[0,1]},{"inputs":[-80,30.5],"expectedOutputs":[0,1]},{"inputs":[-87,109.5],"expectedOutputs":[0,1]},{"inputs":[-84,185.5],"expectedOutputs":[0,1]},{"inputs":[-143,110.5],"expectedOutputs":[0,1]},{"inputs":[-135,144.5],"expectedOutputs":[0,1]},{"inputs":[-124,102.5],"expectedOutputs":[0,1]},{"inputs":[-175,71.5],"expectedOutputs":[0,1]},{"inputs":[-175,-9.5],"expectedOutputs":[0,1]},{"inputs":[-37,-67.5],"expectedOutputs":[0,1]},{"inputs":[-36,32.5],"expectedOutputs":[0,1]},{"inputs":[-3,-4.5],"expectedOutputs":[0,1]},{"inputs":[84,-7.5],"expectedOutputs":[0,1]},{"inputs":[96,-3.5],"expectedOutputs":[0,1]},{"inputs":[97,-9.5],"expectedOutputs":[0,1]},{"inputs":[122,-9.5],"expectedOutputs":[0,1]},{"inputs":[100,-0.5],"expectedOutputs":[0,1]},{"inputs":[104,-12.5],"expectedOutputs":[0,1]},{"inputs":[7,52.5],"expectedOutputs":[0,1]},{"inputs":[56,60.5],"expectedOutputs":[0,1]},{"inputs":[83,-53.5],"expectedOutputs":[0,1]},{"inputs":[-6,106.5],"expectedOutputs":[0,1]},{"inputs":[51,12.5],"expectedOutputs":[0,1]},{"inputs":[19,-27.5],"expectedOutputs":[0,1]},{"inputs":[41,81.5],"expectedOutputs":[0,1]},{"inputs":[24,-36.5],"expectedOutputs":[0,1]},{"inputs":[-272,-62.5],"expectedOutputs":[1,0]},{"inputs":[-185,-139.5],"expectedOutputs":[1,0]},{"inputs":[-15,-184.5],"expectedOutputs":[1,0]},{"inputs":[195,-182.5],"expectedOutputs":[1,0]},{"inputs":[101,-179.5],"expectedOutputs":[1,0]},{"inputs":[268,-128.5],"expectedOutputs":[1,0]},{"inputs":[305,-66.5],"expectedOutputs":[1,0]},{"inputs":[319,15.5],"expectedOutputs":[1,0]},{"inputs":[324,115.5],"expectedOutputs":[1,0]},{"inputs":[278,181.5],"expectedOutputs":[1,0]},{"inputs":[153,229.5],"expectedOutputs":[1,0]},{"inputs":[79,241.5],"expectedOutputs":[1,0]},{"inputs":[-81,254.5],"expectedOutputs":[1,0]},{"inputs":[-185,243.5],"expectedOutputs":[1,0]},{"inputs":[-203,183.5],"expectedOutputs":[1,0]},{"inputs":[-260,125.5],"expectedOutputs":[1,0]},{"inputs":[-274,37.5],"expectedOutputs":[1,0]},{"inputs":[-285,-24.5],"expectedOutputs":[1,0]},{"inputs":[-426,-75.5],"expectedOutputs":[1,0]},{"inputs":[-356,-170.5],"expectedOutputs":[1,0]},{"inputs":[-352,-94.5],"expectedOutputs":[1,0]},{"inputs":[-400,45.5],"expectedOutputs":[1,0]},{"inputs":[-349,66.5],"expectedOutputs":[1,0]},{"inputs":[-487,168.5],"expectedOutputs":[1,0]},{"inputs":[-496,356.5],"expectedOutputs":[1,0]},{"inputs":[-465,457.5],"expectedOutputs":[1,0]},{"inputs":[-364,455.5],"expectedOutputs":[1,0]},{"inputs":[-174,448.5],"expectedOutputs":[1,0]},{"inputs":[17,438.5],"expectedOutputs":[1,0]},{"inputs":[202,434.5],"expectedOutputs":[1,0]},{"inputs":[339,435.5],"expectedOutputs":[1,0]},{"inputs":[422,424.5],"expectedOutputs":[1,0]},{"inputs":[478,320.5],"expectedOutputs":[1,0]},{"inputs":[463,119.5],"expectedOutputs":[1,0]},{"inputs":[453,221.5],"expectedOutputs":[1,0]},{"inputs":[456,-3.5],"expectedOutputs":[1,0]},{"inputs":[460,-91.5],"expectedOutputs":[1,0]},{"inputs":[472,-179.5],"expectedOutputs":[1,0]},{"inputs":[480,-306.5],"expectedOutputs":[1,0]},{"inputs":[469,-410.5],"expectedOutputs":[1,0]},{"inputs":[462,-506.5],"expectedOutputs":[1,0]},{"inputs":[368,-512.5],"expectedOutputs":[1,0]},{"inputs":[198,-511.5],"expectedOutputs":[1,0]},{"inputs":[31,-500.5],"expectedOutputs":[1,0]},{"inputs":[284,-516.5],"expectedOutputs":[1,0]},{"inputs":[-74,-504.5],"expectedOutputs":[1,0]},{"inputs":[-160,-503.5],"expectedOutputs":[1,0]},{"inputs":[-300,-500.5],"expectedOutputs":[1,0]},{"inputs":[-380,-508.5],"expectedOutputs":[1,0]},{"inputs":[-453,-509.5],"expectedOutputs":[1,0]},{"inputs":[-488,-472.5],"expectedOutputs":[1,0]},{"inputs":[-480,-392.5],"expectedOutputs":[1,0]},{"inputs":[-479,-283.5],"expectedOutputs":[1,0]},{"inputs":[-474,-115.5],"expectedOutputs":[1,0]},{"inputs":[-480,73.5],"expectedOutputs":[1,0]},{"inputs":[-396,202.5],"expectedOutputs":[1,0]},{"inputs":[-271,251.5],"expectedOutputs":[1,0]},{"inputs":[-386,297.5],"expectedOutputs":[1,0]},{"inputs":[-370,397.5],"expectedOutputs":[1,0]},{"inputs":[-251,357.5],"expectedOutputs":[1,0]},{"inputs":[-87,326.5],"expectedOutputs":[1,0]},{"inputs":[-93,377.5],"expectedOutputs":[1,0]},{"inputs":[81,331.5],"expectedOutputs":[1,0]},{"inputs":[4,326.5],"expectedOutputs":[1,0]},{"inputs":[314,323.5],"expectedOutputs":[1,0]},{"inputs":[207,283.5],"expectedOutputs":[1,0]},{"inputs":[392,365.5],"expectedOutputs":[1,0]},{"inputs":[362,240.5],"expectedOutputs":[1,0]},{"inputs":[403,99.5],"expectedOutputs":[1,0]},{"inputs":[402,-80.5],"expectedOutputs":[1,0]},{"inputs":[330,-151.5],"expectedOutputs":[1,0]},{"inputs":[430,-233.5],"expectedOutputs":[1,0]},{"inputs":[198,-282.5],"expectedOutputs":[1,0]},{"inputs":[89,-307.5],"expectedOutputs":[1,0]},{"inputs":[351,-356.5],"expectedOutputs":[1,0]},{"inputs":[333,-243.5],"expectedOutputs":[1,0]},{"inputs":[195,-388.5],"expectedOutputs":[1,0]},{"inputs":[397,-454.5],"expectedOutputs":[1,0]},{"inputs":[292,-407.5],"expectedOutputs":[1,0]},{"inputs":[-271,-220.5],"expectedOutputs":[1,0]},{"inputs":[-407,-269.5],"expectedOutputs":[1,0]},{"inputs":[-408,-342.5],"expectedOutputs":[1,0]},{"inputs":[-296,-335.5],"expectedOutputs":[1,0]},{"inputs":[-144,-269.5],"expectedOutputs":[1,0]},{"inputs":[-37,-352.5],"expectedOutputs":[1,0]},{"inputs":[-6,-262.5],"expectedOutputs":[1,0]},{"inputs":[-175,-382.5],"expectedOutputs":[1,0]},{"inputs":[-317,-414.5],"expectedOutputs":[1,0]},{"inputs":[-424,-442.5],"expectedOutputs":[1,0]},{"inputs":[-178,-450.5],"expectedOutputs":[1,0]},{"inputs":[-35,-442.5],"expectedOutputs":[1,0]},{"inputs":[128,-436.5],"expectedOutputs":[1,0]},{"inputs":[62,-385.5],"expectedOutputs":[1,0]},{"inputs":[-96,-205.5],"expectedOutputs":[1,0]},{"inputs":[-287,184.5],"expectedOutputs":[1,0]},{"inputs":[200,371.5],"expectedOutputs":[1,0]},{"inputs":[374.5,301.5],"expectedOutputs":[1,0]},{"inputs":[333.5,369.5],"expectedOutputs":[1,0]},{"inputs":[215.5,365.5],"expectedOutputs":[1,0]},{"inputs":[263.5,297.5],"expectedOutputs":[1,0]},{"inputs":[91.5,401.5],"expectedOutputs":[1,0]},{"inputs":[-148.5,409.5],"expectedOutputs":[1,0]},{"inputs":[-251.5,405.5],"expectedOutputs":[1,0]},{"inputs":[-326.5,346.5],"expectedOutputs":[1,0]},{"inputs":[-464.5,248.5],"expectedOutputs":[1,0]},{"inputs":[-325.5,268.5],"expectedOutputs":[1,0]},{"inputs":[-430.5,126.5],"expectedOutputs":[1,0]},{"inputs":[-480.5,-44.5],"expectedOutputs":[1,0]},{"inputs":[-353.5,-47.5],"expectedOutputs":[1,0]},{"inputs":[-443.5,-189.5],"expectedOutputs":[1,0]},{"inputs":[-275.5,-292.5],"expectedOutputs":[1,0]},{"inputs":[-365.5,-256.5],"expectedOutputs":[1,0]},{"inputs":[-382.5,-380.5],"expectedOutputs":[1,0]},{"inputs":[-245.5,-342.5],"expectedOutputs":[1,0]},{"inputs":[-239.5,-432.5],"expectedOutputs":[1,0]},{"inputs":[-32.5,-417.5],"expectedOutputs":[1,0]},{"inputs":[-123.5,-306.5],"expectedOutputs":[1,0]},{"inputs":[151.5,-354.5],"expectedOutputs":[1,0]},{"inputs":[131.5,-249.5],"expectedOutputs":[1,0]},{"inputs":[305.5,-344.5],"expectedOutputs":[1,0]},{"inputs":[258.5,-220.5],"expectedOutputs":[1,0]},{"inputs":[421.5,-174.5],"expectedOutputs":[1,0]},{"inputs":[440.5,-370.5],"expectedOutputs":[1,0]},{"inputs":[339.5,-441.5],"expectedOutputs":[1,0]},{"inputs":[154.5,-489.5],"expectedOutputs":[1,0]},{"inputs":[257.5,-488.5],"expectedOutputs":[1,0]},{"inputs":[-242.5,-471.5],"expectedOutputs":[1,0]},{"inputs":[381.5,42.5],"expectedOutputs":[1,0]},{"inputs":[388.5,171.5],"expectedOutputs":[1,0]},{"inputs":[286.5,224.5],"expectedOutputs":[1,0]},{"inputs":[210.5,212.5],"expectedOutputs":[1,0]},{"inputs":[130.5,294.5],"expectedOutputs":[1,0]},{"inputs":[0.5,377.5],"expectedOutputs":[1,0]},{"inputs":[-160.5,342.5],"expectedOutputs":[1,0]},{"inputs":[-352.5,130.5],"expectedOutputs":[1,0]},{"inputs":[52.5,-239.5],"expectedOutputs":[1,0]},{"inputs":[41.5,-315.5],"expectedOutputs":[1,0]},{"inputs":[-63.5,-235.5],"expectedOutputs":[1,0]},{"inputs":[-349.5,-472.5],"expectedOutputs":[1,0]},{"inputs":[397.5,-30.5],"expectedOutputs":[1,0]},{"inputs":[197.5,-142.5],"expectedOutputs":[1,0]},{"inputs":[-187.5,-218.5],"expectedOutputs":[1,0]},{"inputs":[-221.5,300.5],"expectedOutputs":[1,0]},{"inputs":[78.5,283.5],"expectedOutputs":[1,0]},{"inputs":[387.5,-287.5],"expectedOutputs":[1,0]},{"inputs":[-433.5,407.5],"expectedOutputs":[1,0]},{"inputs":[-210.5,-42.5],"expectedOutputs":[0,1]},{"inputs":[-234.5,-102.5],"expectedOutputs":[0,1]},{"inputs":[-135.5,-117.5],"expectedOutputs":[0,1]},{"inputs":[-105.5,-69.5],"expectedOutputs":[0,1]},{"inputs":[-56.5,-21.5],"expectedOutputs":[0,1]},{"inputs":[10.5,-102.5],"expectedOutputs":[0,1]},{"inputs":[160.5,-78.5],"expectedOutputs":[0,1]},{"inputs":[128.5,17.5],"expectedOutputs":[0,1]},{"inputs":[-45.5,194.5],"expectedOutputs":[0,1]},{"inputs":[-100.5,141.5],"expectedOutputs":[0,1]},{"inputs":[57.5,179.5],"expectedOutputs":[0,1]},{"inputs":[-24.5,227.5],"expectedOutputs":[0,1]},{"inputs":[-82.5,225.5],"expectedOutputs":[0,1]},{"inputs":[194.5,33.5],"expectedOutputs":[0,1]},{"inputs":[174.5,96.5],"expectedOutputs":[0,1]},{"inputs":[200.5,66.5],"expectedOutputs":[0,1]},{"inputs":[212.5,-53.5],"expectedOutputs":[0,1]},{"inputs":[-64.5,62.5],"expectedOutputs":[0,1]},{"inputs":[-111.5,54.5],"expectedOutputs":[0,1]},{"inputs":[-26.5,144.5],"expectedOutputs":[0,1]},{"inputs":[57.5,96.5],"expectedOutputs":[0,1]},{"inputs":[-104.5,-146.5],"expectedOutputs":[0,1]},{"inputs":[-143.5,-75.5],"expectedOutputs":[0,1]},{"inputs":[-139.5,-14.5],"expectedOutputs":[0,1]},{"inputs":[-149.5,102.5],"expectedOutputs":[0,1]},{"inputs":[-240.5,-133.5],"expectedOutputs":[0,1]},{"inputs":[-267.5,-176.5],"expectedOutputs":[0,1]},{"inputs":[271.5,-37.5],"expectedOutputs":[0,1]},{"inputs":[229.5,51.5],"expectedOutputs":[0,1]},{"inputs":[61.5,200.5],"expectedOutputs":[0,1]},{"inputs":[-26.5,252.5],"expectedOutputs":[0,1]},{"inputs":[-139.5,170.5],"expectedOutputs":[0,1]},{"inputs":[42.5,209.5],"expectedOutputs":[0,1]},{"inputs":[-64.5,286.5],"expectedOutputs":[0,1]},{"inputs":[-211.5,1.5],"expectedOutputs":[0,1]},{"inputs":[243.5,-89.5],"expectedOutputs":[0,1]},{"inputs":[210.5,-9.5],"expectedOutputs":[0,1]},{"inputs":[122.5,123.5],"expectedOutputs":[0,1]},{"inputs":[-214.5,-165.5],"expectedOutputs":[0,1]},{"inputs":[-174.5,117.5],"expectedOutputs":[0,1]},{"inputs":[-121.5,249.5],"expectedOutputs":[0,1]},{"inputs":[16.5,237.5],"expectedOutputs":[0,1]}]');

const STEP_SIZE = 0.00001; //when the cost starts to fluctuate, just reduce the STEP_SIZE
const MINI_BATCH_SIZE = 300;






const Main = () => {
    const network = RetrieveNeuralNetwork([2, 3, 3, 2]);

    CANVAS.linkCanvas("canvas");
    VisualiseData(CANVAS, DATA);
    VisualiseNeuralNetwork(CANVAS, network, 30);
    console.log("Cost: " + CalculateCost(network, DATA));

    const interval = setInterval(() => {
        CANVAS.clearCanvas();
        VisualiseData(CANVAS, DATA);
        VisualiseNeuralNetwork(CANVAS, network, 100);

        Train(network, DATA, 40, STEP_SIZE, MINI_BATCH_SIZE, () => {
            console.log("Cost: " + CalculateCost(network, DATA));
        });
    }, 1000);

    document.onkeydown = ($e) => {
        if ($e.key == " ") {
            clearInterval(interval);
        }
    }

    /*
    //Managed to bring cost down to 0.01941260931267366
    - Network: [2, 3, 3, 2] (Sigmoid Activation)
    - Bias data: [0,0,-5.38214000000005,6.136080000000381,-3.0229199999997847,-0.7808200000000335,0.004840000000000427,1.0280799999999584,-1.1979600000001118,1.1139000000001207]
    - Weight data: [0.005556855132202739,0.023981119762710806,0.00672402034274619,-0.025148655534003923,-0.007637768941736185,0.00837886903301327,-6.256584035851966,5.802006574277471,5.896808797464952,2.6402836635449067,-1.8937382791792197,-3.008323110778759,-3.927738817201862,1.7483417315772702,4.3901105034097645,-5.1998253851105645,5.292505405755149,4.096089169894945,-4.2166749862481385,8.063760569432295,-7.91241973733379]
    */
}
Main();



const Testing = () => {
    const network = RetrieveNeuralNetwork([2, 3, 3, 2]);

    const startTime = Date.now();
    Train(network, DATA, 1000, STEP_SIZE, MINI_BATCH_SIZE)
    const endTime = Date.now();

    console.log("Cost: " + CalculateCost(network, DATA));
    console.log("Time: " + ((endTime - startTime) / 1000) + " seconds");


    /*
    //Testing data:
    - Network: [2, 3, 3, 2]
    - Reset network (cleared storage data) for every test run

    //1000 cycles backpropogation:
    1. Cost: 0.19317093182300968, Time: 12.909 seconds
    2. Cost: 0.23131152956473486, Time: 12.915 seconds
    3. Cost: 0.25408447357964326, Time: 13.226 seconds
    4. Cost: 0.1616202893890289, Time: 12.692 seconds
    5. Cost: 0.20452779158951404, Time: 13.151 seconds

    //1000 cycles finite 
    1. Cost: 0.2426180347351767, Time: 116.649 seconds
    2. Cost: 0.25792476732363817, Time: 117.197 seconds
    3. Cost: 0.25070170031683264, Time: 116.087 seconds
    4. Cost: 0.25025190879449993, Time: 114.718 seconds
    5. Cost: 0.2346851979540269, Time: 117.151 seconds
    */
}
//Testing();